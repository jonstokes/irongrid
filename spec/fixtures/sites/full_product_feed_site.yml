---
site:
  name: Brownells
  domain: www.brownells.com
  read_interval: 7200
  sessions:
  - session_definition: { $key: global/standard_xml_session }
    object_adapters: [{ $key: www.brownells.com/product_feed }]
    urls:
    - url: http://datafeed.avantlink.com/download_feed.php?id=153279&auth=ad2088b086dfc98f918a37e8fa32fcf3&incr=all-status
  registrations:
    object_adapter:
      www.brownells.com/product_feed:
        $key: globals/adapter
        scripts:
        - globals/*
        - www.brownells.com/link_postfix
        schema: { $key: Listing }
        xpath: //Products/Product
        attribute:
          condition: [{ value: new }]
          availability: [{ value: in_stock }]
          location: [{ value: "200 South Front Street, Montezuma, Iowa 50171" }]
          type: [{ value: RetailListing }]
          url:
            - find_by_xpath:
                xpath: .//Buy_Link
          title:
            - find_by_xpath:
                xpath: .//Product_Name
          description:
            - find_by_xpath:
                xpath: .//Long_Description
          image:
            - find_by_xpath:
                xpath: .//Image_URL
          sale_price_in_cents:
            - find_by_xpath:
                xpath: .//Sale_Price
          price_in_cents:
            - find_by_xpath:
                xpath: .//Retail_Price
          availability:
            - classify_by_xpath:
                type: out_of_stock
                xpath: .//Status
                pattern: !ruby/regexp '/^Removed/i'
          product_category1:
            - classify_by_xpath:
                type: Ammunition
                xpath: .//Category
                pattern: !ruby/regexp '/Ammunition/i'
            - classify_by_xpath:
                type: Optics
                xpath: .//Category
                pattern: !ruby/regexp '/Optics/i'
            - classify_by_xpath:
                type: Accessories
                xpath: .//Category
                pattern: !ruby/regexp '/Books|Cleaning|Gunsmith|Magazines|Reloading|Parts|Accessories/i'
    script:
      www.brownells.com/link_postfix:
        $file: link_postfix.rb
